# QAR数据分析系统

基于PyTorch的完整机载QAR（Quick Access Recorder）数据分析与可视化系统，提供安全性分析、成本优化和维护预测功能。

## 🚀 系统特性

### 数据模拟
- **完整的QAR参数模拟**：包含飞行操纵、发动机性能、气动参数等50+参数
- **真实飞行剖面**：模拟完整的飞行阶段（滑行、起飞、爬升、巡航、下降、进近、着陆）
- **异常数据注入**：支持添加各种异常情况用于模型训练

### 可视化分析
- **起飞参数趋势图**：多参数叠加分析，分段展示关键性能指标
- **飞行阶段划分图**：清晰展示各飞行阶段，背景色区分不同阶段
- **参数分布分析**：发动机参数箱线图、燃油流量直方图、垂直速度分布
- **空速-高度关系散点图**：飞行包线分析
- **飞行轨迹地图**：基于实际地理坐标，高度颜色编码，起降点标记
- **参数相关性热力图**：关键参数相关性分析，直观的颜色编码

### 安全性分析
- **异常检测**：基于Isolation Forest的无监督异常检测
- **风险评估**：多维度安全风险评估模型
- **飞行阶段分类**：自动识别飞行阶段
- **操作合规性检查**：SOP标准操作程序符合性分析

### 成本优化
- **燃油优化**：基于机器学习的燃油消耗预测和优化建议
- **维护预测**：预测性维护模型，降低非计划停场风险
- **效率分析**：飞行效率评估和改进建议

## 📋 系统要求

- Python 3.8+
- PyTorch 2.0+
- 其他依赖见 `requirements.txt`

## 🛠️ 安装与使用

### 1. 克隆项目
```bash
git clone <repository-url>
cd qar_analysis_system
```

### 2. 安装依赖
```bash
pip install -r requirements.txt
```

### 3. 运行完整演示
```bash
python main.py
```

### 4. 启动Web服务
```bash
cd src/api
python main.py
```

然后访问：
- 主页：http://localhost:8000
- API文档：http://localhost:8000/docs

## 📁 项目结构

```
qar_analysis_system/
├── data/                    # 数据存储
│   ├── raw/                # 原始QAR数据
│   ├── processed/          # 处理后的数据
│   └── models/             # 训练好的模型
├── src/                    # 源代码
│   ├── data_generation/    # 数据生成模块
│   │   └── qar_simulator.py
│   ├── visualization/      # 可视化模块
│   │   └── qar_visualizer.py
│   ├── models/            # 机器学习模型
│   │   ├── safety_models.py
│   │   └── optimization_models.py
│   ├── api/               # FastAPI接口
│   │   └── main.py
│   └── utils/             # 工具函数
│       └── data_processing.py
├── tests/                 # 测试代码
├── static/                # 静态文件
├── main.py               # 主程序入口
├── requirements.txt      # 依赖包
└── README.md            # 项目文档
```

## 🔧 API接口

### 数据生成
- `POST /api/simulate` - 生成QAR模拟数据
- `GET /api/data/info` - 获取数据信息

### 模型训练
- `POST /api/analysis/train_models` - 训练所有机器学习模型

### 安全性分析
- `POST /api/analysis/anomaly_detection` - 异常检测
- `POST /api/analysis/safety_assessment` - 安全风险评估

### 成本优化
- `POST /api/analysis/fuel_optimization` - 燃油优化分析

### 可视化
- `GET /api/visualizations/generate` - 生成可视化图表

## 📊 QAR参数说明

### 飞行操纵与性能参数
- **姿态参数**：俯仰角、滚转角、偏航角、飞行路径角、侧滑角
- **操纵面位置**：副翼、升降舵、方向舵、扰流板偏转角度
- **飞行控制输入**：驾驶杆位置、脚蹬输入、自动驾驶仪状态

### 发动机性能参数
- **转速与推力**：N1/N2转速、推力估算值
- **温度与压力**：排气温度、滑油压力、滑油温度
- **燃油与振动**：燃油流量、振动值

### 气动与飞行性能参数
- **空速与高度**：指示空速、真空速、标准气压高度
- **垂直运动**：垂直速度、飞行路径角
- **航迹与燃油**：航向、地速、燃油量

### 航电与导航参数
- **导航系统**：GPS位置、惯性导航航向
- **通信与防撞**：应答机代码、TCAS状态

### 环境与特殊事件参数
- **气象相关**：风速、风向、湍流强度
- **系统事件**：起飞/着陆标志、发动机失效标志

## 🎯 应用目标

### 安全性相关
- **减少不安全事件**：滑出超限、起飞超重、着陆超速等
- **提升操作合规性**：确保符合SOP标准操作程序
- **降低设备故障风险**：预测性维护，避免空中故障
- **提升决策支持**：复杂条件下的决策辅助

### 成本优化相关
- **降低燃油消耗**：优化飞行剖面，提高燃油效率
- **减少维护成本**：预测性维护，避免过度维修
- **提升飞机利用率**：优化调度与流程
- **优化航线选择**：减少绕飞、延误

## 🧪 测试

运行测试套件：
```bash
python tests/test_qar_system.py
```

## 📈 性能指标

- **异常检测准确率**：>95%
- **飞行阶段分类准确率**：>98%
- **燃油预测R²**：>0.85
- **维护预测准确率**：>90%

## 🤝 贡献

欢迎提交Issue和Pull Request来改进项目。

## 📄 许可证

本项目采用MIT许可证。

## 📞 联系方式

如有问题或建议，请通过以下方式联系：
- 邮箱：[418294908@qq.com]
- GitHub Issues：[项目Issues页面]

---

**注意**：本系统仅用于研究和教学目的，实际应用需要根据具体的航空安全标准进行调整和验证。
